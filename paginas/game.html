<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raket Race met Obstakels</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #gameCanvas {
            border: 1px solid black;
            background-color: #e0e0e0;
        }
        #rocketSelection {
            display: flex;
            margin-top: 10px;
            gap: 10px;
            justify-content: center;
        }
        .rocket-option {
            width: 40px;
            height: 60px;
            cursor: pointer;
            border: 1px solid black;
        }
        .rocket-option img {
            width: 100%;
            height: 100%;
        }
        #winner {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .clean-button {
            display: inline-block;
            padding: 10px 20px;
            margin: 0;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            cursor: pointer;
            position: fixed;
            z-index: 1000;
            top: 10px;
            left: 10px;
        }  
        
        #restartButton {
            display: inline-block;
            padding: 10px 20px;
            margin-top: 20px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            position: absolute;
            bottom: 20px;
            z-index: 100;
            border: none ;
        }

    </style>
</head>
<nav>
    <a href="../index.html" class="clean-button">Go to Home</a>
</nav>
<body>
    <div id="chooseRocketText">Kies een raket voor Speler 1:</div>
    <div id="rocketSelection">
        <div class="rocket-option" onclick="selectRocket(1, 'red', 'player1')">
            <img src="https://via.placeholder.com/40x60/ff0000/ffffff?text=R1" alt="Rocket 1">
        </div>
        <div class="rocket-option" onclick="selectRocket(1.2, 'blue', 'player1')">
            <img src="https://via.placeholder.com/40x60/0000ff/ffffff?text=R2" alt="Rocket 2">
        </div>
        <div class="rocket-option" onclick="selectRocket(0.9, 'green', 'player1')">
            <img src="https://via.placeholder.com/40x60/00ff00/ffffff?text=R3" alt="Rocket 3">
        </div>
        <div class="rocket-option" onclick="selectRocket(0.6, 'yellow', 'player1')">
            <img src="https://via.placeholder.com/40x60/ffff00/ffffff?text=R4" alt="Rocket 4">
        </div>
        <div class="rocket-option" onclick="selectRocket(10, 'purple', 'player1')">
            <img src="https://via.placeholder.com/40x60/800080/ffffff?text=R5" alt="Rocket 5">
        </div>
    </div>
    
    <div id="chooseRocketText2" style="display: none;">Kies een raket voor Speler 2:</div>
    <div id="rocketSelection2" style="display: none;">
        <div class="rocket-option" onclick="selectRocket(1, 'red', 'player2')">
            <img src="https://via.placeholder.com/40x60/ff0000/ffffff?text=R1" alt="Rocket 1">
        </div>
        <div class="rocket-option" onclick="selectRocket(1.2, 'blue', 'player2')">
            <img src="https://via.placeholder.com/40x60/0000ff/ffffff?text=R2" alt="Rocket 2">
        </div>
        <div class="rocket-option" onclick="selectRocket(0.9, 'green', 'player2')">
            <img src="https://via.placeholder.com/40x60/00ff00/ffffff?text=R3" alt="Rocket 3">
        </div>
        <div class="rocket-option" onclick="selectRocket(0.6, 'yellow', 'player2')">
            <img src="https://via.placeholder.com/40x60/ffff00/ffffff?text=R4" alt="Rocket 4">
        </div>
        <div class="rocket-option" onclick="selectRocket(10, 'purple', 'player2')">
            <img src="https://via.placeholder.com/40x60/800080/ffffff?text=R5" alt="Rocket 5">
        </div>
    </div>

    <canvas id="gameCanvas" width="640" height="600"></canvas>
    <p id="winner"></p>

    <!-- Restart button -->
    <button id="restartButton" style="display: none;" onclick="restartGame()">Start opnieuw</button>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        let player1Rocket = null;
        let player2Rocket = null;
        let keysPressed = { z: false, q: false, d: false, ArrowUp: false, ArrowLeft: false, ArrowRight: false };
        let gameOver = false;
        let obstacles = [];
        let player1Selected = false;
        let player2Selected = false;

        // Function to draw rockets
        function drawRocket(rocket) {
            ctx.fillStyle = rocket.color;
            ctx.fillRect(rocket.x, rocket.y, rocket.width, rocket.height); 
        }

        // Function to generate obstacles
        function generateObstacles() {
            if (Math.random() < 0.02) {
                let x = Math.random() * (canvas.width - 30);
                obstacles.push({ x: x, y: 0, width: 30, height: 30, speed: 1 });
            }
        }

        // Function to draw obstacles
        function drawObstacles() {
            ctx.fillStyle = "green";
            obstacles.forEach((obstacle) => {
                ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            });
        }

        // Update obstacles' position
        function updateObstacles() {
            obstacles.forEach((obstacle) => {
                obstacle.y += obstacle.speed;
            });

            obstacles = obstacles.filter((obstacle) => obstacle.y < canvas.height);
        }

        // Check if rocket collides with an obstacle
        function checkCollision(rocket) {
            for (let i = 0; i < obstacles.length; i++) {
                let o = obstacles[i];
                if (rocket.x < o.x + o.width &&
                    rocket.x + rocket.width > o.x &&
                    rocket.y < o.y + o.height &&
                    rocket.y + rocket.height > o.y) {
                    return true;
                }
            }
            return false;
        }

        // Check if there is a winner
        function checkWinner() {
            if (player1Rocket && player1Rocket.y <= 0) {
                document.getElementById("winner").innerText = "ðŸš€ Speler 1 wint!";
                gameOver = true;
                document.getElementById("restartButton").style.display = "inline-block"; // Show restart button
            } else if (player2Rocket && player2Rocket.y <= 0) {
                document.getElementById("winner").innerText = "ðŸš€ Speler 2 wint!";
                gameOver = true;
                document.getElementById("restartButton").style.display = "inline-block"; // Show restart button
            }
        }

        // Update rockets' position
        function update() {
            if (!gameOver) {
                // Blue rocket (pijltjestoetsen)
                if (keysPressed.ArrowUp && player2Rocket) player2Rocket.y -= player2Rocket.speed;
                if (keysPressed.ArrowLeft && player2Rocket ) player2Rocket.x -= player2Rocket.speed;
                if (keysPressed.ArrowRight && player2Rocket ) player2Rocket.x += player2Rocket.speed;

                // Red rocket (Z, Q, D)
                if (keysPressed.z && player1Rocket) player1Rocket.y -= player1Rocket.speed;
                if (keysPressed.q && player1Rocket ) player1Rocket.x -= player1Rocket.speed;
                if (keysPressed.d && player1Rocket) player1Rocket.x += player1Rocket.speed;

                // Handle collisions
                if ((player1Rocket && checkCollision(player1Rocket)) || (player2Rocket && checkCollision(player2Rocket))) {
                    gameOver = true;
                    document.getElementById("winner").innerText = "ðŸ’¥ Game Over!";
                    document.getElementById("restartButton").style.display = "inline-block"; // Show restart button
                }

                // Generate and update obstacles
                generateObstacles();
                updateObstacles();
                checkWinner();
            }
        }

        // Draw all game elements
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawRocket(player1Rocket);
            drawRocket(player2Rocket);
            drawObstacles();
        }

        // Game loop
        function gameLoop() {
            update();
            draw();
            if (!gameOver) requestAnimationFrame(gameLoop);
        }

        // Function to select a rocket
        function selectRocket(speed, color, player) {
            if (player === 'player1' && !player1Selected) {
                player1Rocket = { x: 100, y: canvas.height - 60, width: 30, height: 60, speed: speed, color: color };
                player1Selected = true;
                document.getElementById("chooseRocketText").innerText = "Kies een raket voor Speler 2:";
                document.getElementById("rocketSelection").style.display = 'none';
                document.getElementById("rocketSelection2").style.display = 'flex';
            } else if (player === 'player2' && !player2Selected) {
                player2Rocket = { x: 500, y: canvas.height - 60, width: 30, height: 60, speed: speed, color: color };
                player2Selected = true;

                // Start game once both players have selected their rockets
                if (player1Selected && player2Selected) {
                    document.getElementById("chooseRocketText2").style.display = 'none';
                    document.getElementById("rocketSelection2").style.display = 'none';
                    gameLoop();  // Start the game loop
                }
            }
        }

        // Restart the game
        function restartGame() {
            player1Rocket = null;
            player2Rocket = null;
            player1Selected = false;
            player2Selected = false;
            gameOver = false;
            obstacles = [];
            document.getElementById("winner").innerText = "";
            document.getElementById("restartButton").style.display = "none"; // Hide the restart button
            document.getElementById("rocketSelection").style.display = 'flex';
            document.getElementById("chooseRocketText").innerText = "Kies een raket voor Speler 1:";
            gameLoop(); // Restart the game loop
        }

        // Listen for key events
        window.addEventListener("keydown", function (e) {
            keysPressed[e.key] = true;
        });

        window.addEventListener("keyup", function (e) {
            keysPressed[e.key] = false;
        });
    </script>
</body>
</html>
