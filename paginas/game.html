<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raket Race met Obstakels</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('ACHTER.jpg') no-repeat center center fixed;
            background-size: cover;
            z-index: -10;
        }

        nav {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 1;
        }

        .clean-button {
            padding: 10px 20px;
            background-color: rgba(76, 175, 80, 0.8);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }

        #gameCanvas {
            border: 1px solid white;
            background-color: rgba(255, 255, 255, 0.1);
            z-index: 1;
            padding: 0;
            margin: 0;
        }

        #rocketSelection, #rocketSelection2 {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            z-index: 1;
        }

        .rocket-option {
            width: 40px;
            height: 60px;
            cursor: pointer;
            z-index: 1;
        }

        .rocket-option img {
            width: 100%;
            height: 100%;
        }

        #chooseRocketText, #chooseRocketText2 {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
            z-index: 1;
            color: white;
        }

        #restartButton {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            display: none;
            z-index: 1;
        }

        #winner {
            font-size: 24px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div class="background"></div>

    <nav>
        <a href="../index.html" class="clean-button">Go to Home</a>
        <p id="timer" style="position: fixed; top: 10px; right: 10px; font-size: 24px; color: white;">Tijd: 0</p>
    </nav>

    <div id="chooseRocketText">Kies een raket voor Speler 1:</div>
    <div id="rocketSelection">
        <div class="rocket-option" onclick="selectRocket('rocket1.png', 'player1')">
            <img src="rocket1.png" alt="Rocket 1">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket2.png', 'player1')">
            <img src="rocket2.png" alt="Rocket 2">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket3.png', 'player1')">
            <img src="rocket3.png" alt="Rocket 3">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket4.png', 'player1')">
            <img src="rocket4.png" alt="Rocket 4">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket5.png', 'player1')">
            <img src="rocket5.png" alt="Rocket 5">
        </div>
    </div>

    <div id="chooseRocketText2" style="display: none;">Kies een raket voor Speler 2:</div>
    <div id="rocketSelection2" style="display: none;">
        <div class="rocket-option" onclick="selectRocket('rocket1.png', 'player2')">
            <img src="rocket1.png" alt="Rocket 1">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket2.png', 'player2')">
            <img src="rocket2.png" alt="Rocket 2">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket3.png', 'player2')">
            <img src="rocket3.png" alt="Rocket 3">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket4.png', 'player2')">
            <img src="rocket4.png" alt="Rocket 4">
        </div>
        <div class="rocket-option" onclick="selectRocket('rocket5.png', 'player2')">
            <img src="rocket5.png" alt="Rocket 5">
        </div>
    </div>

    <canvas id="gameCanvas" width="640" height="600"></canvas>
    <p id="winner"></p>

    <button id="restartButton" onclick="restartGame()">Start opnieuw</button>

    <script>
        let timer = 0;
    
        let timerStarted = false;  // Voeg deze lijn toe bovenaan je script
    
        let timerInterval;  // Voeg dit toe om de timer bij te houden
    
        function updateTimer() {
            timer++;  // Verhoog de timer met 1 elke keer dat de functie wordt aangeroepen
            document.getElementById("timer").innerText = "Tijd: " + timer;  // Werk de timer tekst bij
        }
    
        const rockets = {
            'rocket1.png': 2, // Rocket 1 met snelheid 2
            'rocket2.png': 4, // Rocket 2 met snelheid 4
            'rocket3.png': 5, // Rocket 3 met snelheid 5
            'rocket4.png': 6, // Rocket 4 met snelheid 6
            'rocket5.png': 7  // Rocket 5 met snelheid 7
        };
    
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
    
        let player1Rocket = null;
        let player2Rocket = null;
        let obstacles = [];
        let gameOver = false;
        let player1Selected = false;
        let player2Selected = false;
        let keysPressed = {};
    
        function selectRocket(rocketImage, player) {
            const speed = rockets[rocketImage]; // Haal de snelheid op uit het object
    
            if (player === 'player1' && !player1Selected) {
                player1Rocket = { 
                    image: new Image(), 
                    src: rocketImage, 
                    x: 100, 
                    y: canvas.height - 45, 
                    speed: speed 
                };
                player1Rocket.image.src = rocketImage;
                player1Selected = true;
                document.getElementById('chooseRocketText').style.display = 'none';
                document.getElementById('rocketSelection').style.display = 'none';
                document.getElementById('chooseRocketText2').style.display = 'block';
                document.getElementById('rocketSelection2').style.display = 'flex';
            } else if (player === 'player2' && !player2Selected) {
                player2Rocket = { 
                    image: new Image(), 
                    src: rocketImage, 
                    x: 500, 
                    y: canvas.height - 45, 
                    speed: speed 
                };
                player2Rocket.image.src = rocketImage;
                player2Selected = true;
                if (player1Selected && player2Selected) {
                    startGame();
                }
            }
        }
    
        // Start het spel
        function startGame() {
            document.getElementById('chooseRocketText2').style.display = 'none';
            document.getElementById('rocketSelection2').style.display = 'none';
            document.getElementById('restartButton').style.display = 'none';
            // Genereer obstakels
            generateObstacles();
            gameLoop();
        }
    
        function gameLoop() {
            if (!gameOver) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
    
                // Teken raketten
                if (player1Rocket) {
                    ctx.drawImage(player1Rocket.image, player1Rocket.x, player1Rocket.y, 30, 45);
                }
    
                if (player2Rocket) {
                    ctx.drawImage(player2Rocket.image, player2Rocket.x, player2Rocket.y, 30, 45);
                }
    
                // Teken obstakels
                drawObstacles();
    
                // Verwerk beweging en botsingen
                handleMovement();
                checkCollision();
                checkRocketCollision(); // Nieuwe functie om botsingen tussen raketten te detecteren
                checkWinner();
    
                requestAnimationFrame(gameLoop);
            }
        }
    
        function handleMovement() {
            // Beweging voor Speler 1
            if (player1Rocket) {
                if (keysPressed['z']) player1Rocket.y -= player1Rocket.speed;
                if (keysPressed['s']) player1Rocket.y += player1Rocket.speed;
                if (keysPressed['q']) player1Rocket.x -= player1Rocket.speed;
                if (keysPressed['d']) player1Rocket.x += player1Rocket.speed;
    
                // Beperkingen op canvasgrenzen
                player1Rocket.y = Math.max(0, Math.min(player1Rocket.y, canvas.height - 45));
                player1Rocket.x = Math.max(0, Math.min(player1Rocket.x, canvas.width - 30));
            }
    
            // Beweging voor Speler 2
            if (player2Rocket) {
                if (keysPressed['arrowup']) player2Rocket.y -= player2Rocket.speed;
                if (keysPressed['arrowdown']) player2Rocket.y += player2Rocket.speed;
                if (keysPressed['arrowleft']) player2Rocket.x -= player2Rocket.speed;
                if (keysPressed['arrowright']) player2Rocket.x += player2Rocket.speed;
    
                // Beperkingen op canvasgrenzen
                player2Rocket.y = Math.max(0, Math.min(player2Rocket.y, canvas.height - 45));
                player2Rocket.x = Math.max(0, Math.min(player2Rocket.x, canvas.width - 30));
            }
        }
    
        function checkRocketCollision() {
            if (
                player1Rocket &&
                player2Rocket &&
                player1Rocket.x < player2Rocket.x + 30 &&
                player1Rocket.x + 30 > player2Rocket.x &&
                player1Rocket.y < player2Rocket.y + 45 &&
                player1Rocket.y + 45 > player2Rocket.y
            ) {
                // Botsing gedetecteerd
                gameOver = true;
                stopTimer();  // Stop de timer bij botsing
                document.getElementById("winner").innerText = "🚀 Beide spelers verliezen!";
                document.getElementById("restartButton").style.display = "block";
            }
        }
    
        // Controleer op botsingen met obstakels
        function checkCollision() {
            obstacles.forEach(obstacle => {
                if (player1Rocket && player1Rocket.x < obstacle.x + obstacle.width &&
                    player1Rocket.x + 30 > obstacle.x && player1Rocket.y < obstacle.y + obstacle.height &&
                    player1Rocket.y + 45 > obstacle.y) {
                    // Botsing met speler 1
                    gameOver = true;
                    stopTimer();  // Stop de timer bij botsing
                    document.getElementById("winner").innerText = "🚀 Speler 1 verliest!";
                    document.getElementById("restartButton").style.display = "block";
                }
    
                if (player2Rocket && player2Rocket.x < obstacle.x + obstacle.width &&
                    player2Rocket.x + 30 > obstacle.x && player2Rocket.y < obstacle.y + obstacle.height &&
                    player2Rocket.y + 45 > obstacle.y) {
                    // Botsing met speler 2
                    stopTimer();  // Stop de timer bij botsing
                    gameOver = true;
                    document.getElementById("winner").innerText = "🚀 Speler 2 verliest!";
                    document.getElementById("restartButton").style.display = "block";
                }
            });
        }
    
        // Genereer obstakels
        function generateObstacles() {
            obstacles = [];
            for (let i = 0; i < 5; i++) {
                let obstacle = {
                    x: Math.random() * (canvas.width - 50), // Willekeurige x-positie
                    y: Math.random() * -300, // Willekeurige start boven canvas
                    width: 50,
                    height: 50,
                    speed: 0.5 + Math.random() * 0.5, // Willekeurige snelheid
                    imageSrc: `obstacle${(i % 3) + 1}.png`,
                };
                obstacle.image = new Image();
                obstacle.image.src = obstacle.imageSrc;
                obstacles.push(obstacle);
            }
        }
    
        // Teken obstakels en update hun positie
        function drawObstacles() {
            obstacles.forEach(obstacle => {
                obstacle.y += obstacle.speed; // Beweeg obstakel naar beneden
    
                // Reset obstakel als het buiten beeld is
                if (obstacle.y > canvas.height) {
                    obstacle.y = Math.random() * -200; // Start weer boven canvas
                    obstacle.x = Math.random() * (canvas.width - obstacle.width); // Willekeurige nieuwe x-positie
                }
    
                if (obstacle.image.complete) {
                    ctx.drawImage(obstacle.image, obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                }
            });
        }
    
        // Functie om het spel opnieuw te starten
        function restartGame() {
            player1Selected = false;
            player2Selected = false;
            player1Rocket = null;
            player2Rocket = null;
            gameOver = false;
            keysPressed = {};
            obstacles = [];
            generateObstacles(); // Nieuwe obstakels genereren
            document.getElementById("winner").innerText = "";
            document.getElementById("restartButton").style.display = "none";
            document.getElementById("rocketSelection").style.display = 'flex';
            document.getElementById("chooseRocketText").style.display = 'block';
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Canvas schoonmaken
            // Reset de timer naar zijn laatste waarde, zonder het terug te zetten naar 0
            document.getElementById("timer").innerText = "Tijd: " + timer;  // Toon de laatste tijd
            timerStarted = false;  // Zorg ervoor dat de timer opnieuw start bij de eerstvolgende toetsdruk
        }
    
        // Controleer wie gewonnen heeft
        function checkWinner() {
            if (player1Rocket.y <= 0) {
                stopTimer();
                document.getElementById("winner").innerText = "🚀 Speler 1 wint!";
                gameOver = true;
                document.getElementById("restartButton").style.display = "block";
            } else if (player2Rocket.y <= 0) {
                stopTimer();
                document.getElementById("winner").innerText = "🚀 Speler 2 wint!";
                gameOver = true;
                document.getElementById("restartButton").style.display = "block";
            }
        }
    
        // Stop de timer bij het einde van het spel
        function stopTimer() {
            clearInterval(timerInterval);  // Stop de timer als het spel eindigt
            timerStarted = false;  // Reset de timer status
        }
    
        // Functie om het spel opnieuw te starten via de "Speel opnieuw" knop
        document.getElementById("restartButton").addEventListener('click', function() {
            restartGame();  // Start het spel opnieuw en reset alles
            // Start de timer opnieuw wanneer het spel herstart wordt
            timerStarted = false;  // Zorg ervoor dat de timer opnieuw start bij de eerstvolgende toetsdruk
        });
    
        window.addEventListener('keydown', function(e) {
            keysPressed[e.key.toLowerCase()] = true;  // Verzeker dat toetsen in kleine letters worden opgeslagen
    
            // Start de timer bij de eerste toetsdruk
            if (!timerStarted && !gameOver) {
                timerStarted = true;
                timerInterval = setInterval(updateTimer, 1000);  // Start de timer op interval
            }
        });
    
        window.addEventListener('keyup', function(e) {
            delete keysPressed[e.key.toLowerCase()];
        });
    </script>
    </body>
    </html>
    